% ===== Setup =====
\documentclass[runningheads]{llncs}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{array}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{enumitem}
\usepackage{xcolor}
\usepackage{tabularx}
\usepackage{longtable}
\usepackage{url}
\usepackage{hyperref}
\usepackage{algorithm}
\usepackage{algpseudocode}

% Font configuration (only if Chinese text is actually used)
% \usepackage{fontspec}
% \newfontfamily\chinesefont{FandolSong}

% Custom commands
\input{custom-commands}

% URL styling
\renewcommand\UrlFont{\color{blue}\rmfamily}
\urlstyle{rm}


% ===== Document =====
\begin{document}

% ===== Title Page =====
\input{title_page}
\title{Privacy-Preserving Synthetic Trajectory Generation for Taxi Route Anomaly Detection: An Integrated DiffTraj-LM-TAD Framework}
\titlerunning{Privacy-Preserving Trajectory Generation for Anomaly Detection}
\author{Mateusz K{\k e}dzia\inst{1}\orcidID{0009-0001-4296-4479}}
\authorrunning{K{\k e}dzia M.G.}
\institute{Vrije Universiteit Amsterdam, Amsterdam}
\maketitle

\begin{abstract}
This study addresses the critical challenge of generating synthetic taxi trajectory datasets that preserve essential characteristics for anomaly detection research while ensuring passenger privacy protection. Urban taxi trajectory data contains sensitive location information that limits its availability for research purposes, creating a significant barrier to advancing anomaly detection methodologies. We propose a comprehensive framework for synthetic trajectory data generation that maintains statistical fidelity, behavioral patterns, and anomaly characteristics of real taxi routes while providing strong privacy guarantees.

Our approach leverages LM-TAD (Language Model for Trajectory Anomaly Detection) integrated with DiffTraj diffusion-based generation to understand normal and anomalous trajectory patterns through iterative refinement, extracting key statistical and behavioral properties that must be preserved in synthetic generation. The framework implements multiple privacy protection mechanisms including differential privacy integration, trajectory-level anonymization, and synthetic data decoupling to prevent inference of individual trajectories from generated data. Comprehensive evaluation demonstrates that synthetic datasets maintain the essential characteristics necessary for effective anomaly detection while providing strong privacy protection, enabling continued research advancement without compromising passenger confidentiality.

\keywords{Synthetic data generation \and Trajectory anomaly detection \and Privacy preservation \and Urban transportation \and Taxi routing}
\end{abstract}

\newpage

% ===== Content =====

\section{Introduction}
\label{sec:introduction}

Urban taxi services have become increasingly important as cities grow more complex and public transportation networks struggle to serve all areas effectively. While taxis offer flexible, door-to-door transportation that fills critical gaps in urban mobility, they also present unique challenges that have gained significant attention in recent transportation research.

A particularly concerning issue in taxi operations is route inefficiency, where drivers deviate from optimal paths for various reasons. While some deviations can be justified by real-time traffic conditions or passenger preferences, others appear to stem from driver inexperience, navigation errors, or potentially deliberate route manipulation. These inefficiencies not only increase costs for passengers but also contribute to urban congestion and environmental impacts through unnecessary fuel consumption.

Machine learning approaches, particularly anomaly detection algorithms, have shown promise for identifying problematic routing patterns in transportation data. Traditional statistical methods can identify obvious deviations, but they often struggle with the contextual complexity of urban navigation decisions. Deep learning techniques offer better pattern recognition capabilities, yet they face practical limitations including the need for large labeled datasets and interpretability requirements for regulatory applications.

The development of effective anomaly detection systems for taxi route inefficiency faces a fundamental obstacle: the sensitive nature of location data severely limits access to real trajectory datasets for research purposes. This creates a critical research bottleneck where the very data needed to identify and prevent route manipulation remains inaccessible due to privacy concerns. Current privacy protection methods often destroy the subtle spatio-temporal patterns that anomaly detection algorithms need to function effectively, creating a paradox where stronger privacy measures undermine the utility of the data for legitimate research into transportation efficiency.

Synthetic data generation has emerged as a potential solution to this privacy-utility dilemma specifically for trajectory analysis. By creating artificial datasets that preserve essential statistical properties and anomaly characteristics of real taxi routes while protecting individual privacy, researchers could develop and evaluate route anomaly detection systems without compromising passenger confidentiality. However, trajectory data presents unique challenges for synthetic generation due to its complex spatio-temporal characteristics, urban context dependencies, and the critical need to preserve both normal routing patterns and subtle anomalous behavioral signatures that indicate route inefficiency.

This thesis proposes a novel framework for generating synthetic trajectory datasets that maintains the statistical and behavioral properties necessary for effective anomaly detection research while addressing critical privacy concerns. The approach focuses specifically on preserving the complex spatio-temporal patterns inherent in urban taxi operations, enabling privacy-preserving research and development in trajectory anomaly detection systems without requiring access to sensitive real-world data.

\section{Literature Review}
\label{sec:literature-review}

\subsection{Trajectory Anomaly Detection}
\label{sec:anomaly-review}

\subsubsection{Statistical and Traditional Methods}
\label{sec:statistical-traditional}

Statistical approaches demonstrate the essential properties that synthetic trajectory data must preserve to maintain utility for anomaly detection research. Different detection methods rely on fundamentally distinct trajectory characteristics, establishing specific requirements for data generation.

Distance-based methods like Wang et al.~\cite{wangStatisticalFrameworkTaxi2020} work by comparing route lengths and travel patterns against historical distributions. For synthetic data to support this type of research, it must maintain realistic distance distributions and route variation patterns. Similarly, density-based approaches such as He et al.~\cite{heEnhancedDBSCANMultiple2020} depend on preserving local neighborhood structures - how trajectories cluster together spatially affects detection performance significantly.

The most successful traditional method has been isolation-based detection, particularly Zhang et al.~\cite{zhangIBATDetectingAnomalous2011}'s iBAT algorithm. This approach groups trajectories by origin-destination pairs and converts routes into symbolic sequences of grid cells. This method establishes two critical requirements for synthetic data generation: preserving origin-destination flow patterns and maintaining consistent spatial traversal sequences between locations.

Traditional methods also demonstrate a significant research gap that synthetic data generation addresses. Most approaches struggle with parameter sensitivity and insufficient labeled anomaly data~\cite{zhangIBATDetectingAnomalous2011}, creating challenges for systematic evaluation of new detection algorithms. Synthetic generation provides a solution through controlled datasets with known anomaly labels and adjustable parameters for systematic evaluation.

\subsubsection{Deep Learning Approaches}
\label{sec:deep-learning}

Deep learning approaches present distinctive challenges for synthetic data generation, as these methods depend on learning complex patterns that traditional approaches cannot capture.

Autoencoder-based detection, exemplified by Huang et al.~\cite{huangLSTMAutoencodersAttention2021}'s LSTM-AE-Attention model, operates by learning to reconstruct normal trajectory patterns. Anomalous trajectories that exhibit poor reconstruction quality are identified as suspicious. This approach establishes a critical requirement for synthetic data: preservation of subtle temporal patterns and sequence dependencies that characterize real trajectories, as their absence would compromise reconstruction-based detection effectiveness. The study also identifies a practical challenge where real datasets exhibit significant imbalance, with approximately 12 normal trajectories for every anomalous one, complicating training processes.

\textbf{Language Model-based Trajectory Anomaly Detection.} A significant breakthrough in trajectory anomaly detection comes from the application of language modeling techniques to spatial-temporal sequences. Mbuya et al.~\cite{mbuyaTrajectoryAnomalyDetection2024} introduce LM-TAD, an autoregressive causal-attention model that treats trajectories as sequences of tokens, similar to language statements. This approach leverages the inherent similarities between language and trajectory data, where both consist of ordered elements requiring coherence through external rules and contextual variations.

LM-TAD learns probability distributions over trajectories using transformer architectures, enabling identification of anomalous locations through perplexity and surprisal rate metrics. The model incorporates user-specific tokens to account for individual behavior patterns, significantly enhancing anomaly detection tailored to user context. This approach demonstrates superior performance on both synthetic and real-world datasets, particularly excelling at detecting user-contextual anomalies on the Pattern of Life (PoL) dataset while achieving competitive results on taxi trajectory data.

The language model paradigm addresses several critical limitations of traditional deep learning approaches: it provides interpretable anomaly scores through perplexity metrics, supports online detection through attention state caching, and handles diverse trajectory representations including GPS coordinates, staypoints, and activity types. This versatility makes it particularly suitable for synthetic data generation applications, as it can work with various data formats while maintaining strong detection performance. The integration of LM-TAD with diffusion-based generation forms a core component of the methodology described in Section~\ref{sec:methodology}.

More recent work with diffusion models, such as Li et al.~\cite{liDiffusionModelsVehicle2023}'s DiffTAD, demonstrates that synthetic trajectory generation can be directly applied for anomaly detection. Their approach treats trajectory generation as a denoising process, achieving significantly superior performance compared to traditional methods. This suggests potential adaptation of synthetic data generation techniques developed for privacy protection to anomaly detection applications.

Deep learning methods present specific requirements for synthetic data research, requiring large training datasets and performing optimally when learning from diverse trajectory patterns. Synthetic data generation addresses these requirements by providing abundant, diverse trajectory data that preserves essential characteristics necessary for effective anomaly detection.

\subsubsection{Spatio-Temporal Pattern Analysis}
\label{sec:spatio-temporal}

Identifying the critical patterns in trajectory data defines the preservation requirements for synthetic generation. Research demonstrates that trajectories exhibit multi-level structural properties essential for anomaly detection algorithm effectiveness.

At the spatial level, Zhang et al.~\cite{zhangIBATDetectingAnomalous2011} demonstrate that converting continuous GPS traces into grid-based symbolic sequences achieves effective anomaly detection. This indicates that synthetic data need not precisely replicate individual GPS coordinates, but must preserve the sequence of spatial regions traversed by vehicles. Their approach effectively manages variable GPS sampling rates, which is significant given that synthetic data may exhibit different temporal characteristics than real data.

Temporal patterns exhibit greater complexity than initially apparent. Chen et al.~\cite{chenTemporalContextAwareRoute2021} demonstrate that normal behavior definitions vary significantly based on temporal context - routes considered normal during off-peak hours may appear highly suspicious during rush hour periods. This requires synthetic data generation to preserve time-dependent behavioral patterns in addition to spatial accuracy.

Large-scale analysis provides significant insights, as demonstrated by Balan et al.~\cite{balanRealTimeTripInformation2011}'s study of 250 million taxi trips. Their findings indicate that urban mobility follows predictable patterns, with normal routes clustering around preferred paths between locations, and these patterns exhibit sufficient repetition to enable statistical prediction. For synthetic data generation, this emphasizes the importance of preserving origin-destination flow patterns and route clustering rather than generating entirely novel trajectory types.

Scalability represents an important practical consideration for synthetic data generation. Wu et al.~\cite{wuSafetySpatialFeature2024} demonstrate that modern anomaly detection requires distributed processing approaches to handle large datasets effectively. Consequently, synthetic data generation methods must produce datasets of sufficient scale and appropriate structure for parallel processing systems.

\subsection{Synthetic Trajectory Data Generation}
\label{sec:generation-review}

Synthetic trajectory generation has evolved rapidly from foundational map matching techniques~\cite{newsonHiddenMarkovMap2009} to sophisticated deep learning frameworks~\cite{caoGeneratingMobilityTrajectories2021,wangGTGGeneralizableTrajectory2025}. This evolution is driven by converging research pressures across multiple domains. What began as solutions to GPS noise and sparsity issues has expanded to address fundamental challenges in trajectory research.

Three critical problems drive this development. First, the parameter sensitivity and labeled data scarcity issues identified in trajectory anomaly detection research (Section~\ref{sec:anomaly-review})~\cite{zhangIBATDetectingAnomalous2011} make it difficult to systematically evaluate detection algorithms. Second, the high re-identification risk that makes real trajectory data unsuitable for research sharing~\cite{raoCATSConditionalAdversarial2023} creates fundamental data access barriers. Third, the need for reproducible evaluation frameworks that traditional privacy methods cannot provide limits research reproducibility.

This convergence shows a fundamental research gap that existing approaches struggle to address simultaneously. Traditional privacy-preserving mechanisms like k-anonymity and differential privacy create utility-privacy trade-offs that render data unsuitable for complex analytical tasks~\cite{jordonPATEGANGeneratingSynthetic2019}. Meanwhile, the controlled datasets needed for systematic anomaly detection evaluation remain unavailable.

Synthetic trajectory generation addresses these challenges by creating artificial datasets that preserve essential mobility patterns for research purposes without exposing individual trajectories~\cite{caoGeneratingMobilityTrajectories2021}. However, success requires solving complex pattern preservation problems across spatial, temporal, and behavioral dimensions~\cite{kongMobilityTrajectoryGeneration2023,merhiSyntheticTrajectoryGeneration2024}. This establishes the foundation for understanding why comprehensive privacy protection mechanisms are essential for practical deployment of synthetic trajectory generation systems.

\subsubsection{Evolution of Generation Approaches}

The development of synthetic trajectory generation shows two major research transitions that directly impact anomaly detection utility. Early foundational work and deep learning breakthroughs established the core requirements for pattern preservation, while advanced frameworks address the integration challenges essential for practical deployment.

\textbf{From Foundational Methods to Deep Learning Solutions.} Early trajectory processing research reveals fundamental insights that remain critical for anomaly detection today. Region representation learning~\cite{wangRegionRepresentationLearning2017} and map matching techniques~\cite{newsonHiddenMarkovMap2009} show how spatial relationships must be preserved to maintain the trajectory characteristics that detection algorithms depend on. These insights directly address the spatial traversal sequence requirements identified in isolation-based detection methods like iBAT (Section~\ref{sec:anomaly-review}).

The deep learning transition created a paradigm shift through GAN-based approaches like TrajGen~\cite{caoGeneratingMobilityTrajectories2021}. These approaches demonstrated that neural networks can capture complex spatio-temporal relationships while revealing fundamental challenges in temporal dependency modeling. Vehicle-specific investigations~\cite{bajarunasGenerativeAdversarialNetworks2022} highlight a key insight: GANs excel at spatial modeling but struggle with temporal sequences. This directly impacts the subtle temporal patterns and sequence dependencies that autoencoder-based detection methods require (Section~\ref{sec:anomaly-review})~\cite{huangLSTMAutoencodersAttention2021}.

\textbf{Diffusion Models for Trajectory Generation.} A significant advancement in trajectory generation comes from the adoption of diffusion probabilistic models. DiffTraj~\cite{zhuDiffTrajGeneratingGPS2023} represents a breakthrough approach that combines the generative capabilities of diffusion models with spatial-temporal features derived from real trajectories. The core innovation lies in reconstructing and synthesizing geographic trajectories from white noise through a reverse trajectory denoising process, effectively addressing the training stability issues that plagued earlier GAN-based approaches.

DiffTraj introduces a Trajectory UNet (Traj-UNet) deep neural network to embed conditional information and accurately estimate noise levels during the reverse process. This architecture demonstrates superior performance in generating high-fidelity trajectories while retaining original distributions, significantly outperforming other methods in geo-distribution evaluations. The model's ability to work directly with continuous GPS coordinates makes it particularly suitable for preserving the precise spatial patterns required for effective anomaly detection. These capabilities form the foundation for the methodology presented in Section~\ref{sec:methodology}, where DiffTraj is integrated with LM-TAD for privacy-preserving anomaly detection.

Building on this foundation, Diff-RNTraj~\cite{weiDiffRNTrajStructureawareDiffusion2024} addresses a critical limitation in practical applications by introducing road network-constrained trajectory generation. This structure-aware diffusion model generates trajectories directly on road networks with road-related information, ensuring practical utility while maintaining the generative quality of diffusion approaches. The model handles hybrid trajectory data combining discrete road segments with continuous movement rates, incorporating pre-training strategies and novel loss functions to enhance spatial validity.

These limitations drove architectural innovations including CNN-based transformations~\cite{merhiSyntheticTrajectoryGeneration2024} for spatial distribution capture and RNN approaches~\cite{duRecurrentMarkedTemporal2016} for sequential dependencies. Each approach addresses different aspects of preserving anomaly detection utility.

\textbf{Advanced Integration Approaches.} Recognition of individual approach limitations drives sophisticated hybrid methods that address comprehensive anomaly detection requirements. The Act2Loc framework~\cite{liuAct2LocSyntheticTrajectory2023} shows how machine learning can combine with mechanistic models for enhanced pattern preservation while requiring minimal training data.

Two-stage generation frameworks like TS-TrajGen~\cite{jiangContinuousTrajectoryGeneration2023} solve error accumulation problems through separated structural and continuous generation. These approaches integrate domain knowledge with model-free learning. Cross-city generalization research~\cite{wangGTGGeneralizableTrajectory2025} demonstrates scalable pattern extraction across urban environments, directly addressing the distributed processing and scalability requirements identified for modern anomaly detection systems (Section~\ref{sec:anomaly-review}).

\subsubsection{Architectural Specialization and Paradigm Shifts}

Different architectural approaches excel at capturing distinct aspects of trajectory data, directly impacting pattern preservation required for anomaly detection effectiveness.

\textbf{Sequential vs. Spatial Processing Trade-offs.} The temporal dependencies in trajectory data drive investigation of sequential architectures to address pattern requirements identified in deep learning anomaly detection approaches (Section~\ref{sec:anomaly-review}). The RMTPP framework~\cite{duRecurrentMarkedTemporal2016} shows how RNNs can model event timings and spatial markers simultaneously. This demonstrates the importance of temporal pattern preservation for sequence-dependent detection methods like LSTM-AE-Attention models.

However, RNN-based GANs exhibit training instability compared to CNN models~\cite{merhiSyntheticTrajectoryGeneration2024}. This creates trade-offs between temporal modeling capability and training reliability. Convolutional approaches like the RTCT method~\cite{merhiSyntheticTrajectoryGeneration2024} solve spatial distribution challenges through novel data transformations. Conv1D layers demonstrate superior performance for capturing spatial distributions needed for density-based anomaly detection methods that rely on local neighborhood structures (Section~\ref{sec:anomaly-review}).

This research shows a fundamental insight: CNNs excel at spatial pattern capture but struggle with sequential properties, while RNNs handle temporal dependencies but face convergence challenges.

\textbf{Language Model Paradigm Shift.} Recent advances reconceptualize trajectory generation by treating trajectories as sequences where each spatio-temporal point acts as a "word"~\cite{zhangEndtoendTrajectoryGeneration2025}. This approach addresses both sequential dependencies and spatial constraints simultaneously through autoregressive modeling. Training on finite vocabulary of locations implicitly enforces spatio-temporal validity constraints~\cite{kongMobilityTrajectoryGeneration2023}.

A prime example of this paradigm is TrajGPT~\cite{hsuTrajGPTControlledSynthetic2024}, which introduces controlled synthetic trajectory generation using a multitask transformer-based spatiotemporal model. TrajGPT addresses the novel problem of "controlled" trajectory generation, where specific gaps in partially specified sequences must be filled while maintaining spatiotemporal consistency. Unlike traditional next-location prediction methods, TrajGPT treats trajectory generation as a text infilling problem, leveraging advances in large language models to handle complex spatiotemporal relationships.

The model integrates spatial and temporal components through a Bayesian probability framework within a transformer architecture, ensuring that generated trajectories maintain coherent spatiotemporal patterns. TrajGPT demonstrates significant improvements in temporal accuracy (26-fold improvement) while maintaining over 98\% spatial accuracy, highlighting the potential of language model approaches for trajectory generation tasks.

This paradigm shift leverages broader AI advances to potentially resolve the architectural trade-offs identified in earlier approaches. Zhang et al.~\cite{zhangEndtoendTrajectoryGeneration2025} provide a comprehensive comparison between deep generative models and language models for trajectory generation, demonstrating that language model approaches can effectively capture complex trajectory patterns while maintaining computational efficiency. The approach maintains compatibility with privacy protection mechanisms and cross-city generalization through space syntax theory~\cite{wangGTGGeneralizableTrajectory2025}.

\subsubsection{Privacy-Utility Trade-offs as Design Constraints}

Privacy requirements fundamentally constrain synthetic trajectory generation approaches, creating a central tension that shapes architectural choices and evaluation frameworks. Rather than being an additional feature, privacy preservation emerges as a core design constraint that determines the feasibility and effectiveness of generation methods.

\textbf{Privacy Integration and Evaluation Challenges.} Privacy guarantees require architectural modifications that fundamentally alter generation training processes. The PATE-GAN framework~\cite{jordonPATEGANGeneratingSynthetic2019} demonstrates how differential privacy guarantees modify training to ensure bounded individual influence, while privacy-preserving integration~\cite{raoCATSConditionalAdversarial2023} constrains input representations and DP-SGD integration~\cite{merhiSyntheticTrajectoryGeneration2024} constrains optimization processes. These requirements demonstrate that privacy cannot be added post-hoc but must be integrated from the ground up. Early evaluation approaches assumed utility preservation automatically maintained research value, but privacy-specific metrics like Trajectory-User Linking~\cite{raoCATSConditionalAdversarial2023} show that utility-preserving synthetic data can still leak sensitive information, while the Synthetic Ranking Agreement metric~\cite{jordonPATEGANGeneratingSynthetic2019} demonstrates the need for careful privacy-utility balance.

\textbf{Anomaly Detection Requirements Under Privacy Constraints.} The challenge of maintaining anomaly detection research utility under privacy constraints creates specific requirements that generation methods must satisfy. The need to preserve pattern complexity for deep learning approaches while preventing high re-identification risks creates a design space where privacy constraints and research utility requirements must be jointly optimized rather than sequentially addressed. This fundamental tension determines both the feasibility of privacy-preserving synthetic generation and its effectiveness for anomaly detection research applications.

\subsubsection{Research Gaps and Synthesis Requirements}

The convergence of synthetic trajectory generation research with anomaly detection requirements shows specific gaps that current approaches struggle to address systematically. These gaps represent concrete research opportunities where advances could significantly impact both fields.

\textbf{Pattern Preservation and Evaluation Under Privacy Constraints.} Current synthetic generation methods address either pattern preservation or privacy protection effectively, but struggle with both simultaneously. While isolation-based detection methods like iBAT require the specific origin-destination flow patterns and spatial traversal sequences identified in Section~\ref{sec:anomaly-review}~\cite{zhangIBATDetectingAnomalous2011}, existing privacy-preserving approaches cannot guarantee these patterns survive the protection process.

Similarly, deep learning approaches need large, diverse datasets and subtle temporal patterns that autoencoder-based detection requires~\cite{huangLSTMAutoencodersAttention2021}. However, privacy constraints limit access to necessary training data. Existing evaluation approaches assess utility and privacy independently, but anomaly detection research requires understanding how privacy protection affects detection performance specifically. The Synthetic Ranking Agreement metric~\cite{jordonPATEGANGeneratingSynthetic2019} provides a starting point, but does not address whether synthetic data preserves the specific anomaly characteristics that detection algorithms depend on.

\textbf{Scalability and Systematic Evaluation.} The controlled nature of synthetic datasets could solve the parameter sensitivity and labeled data scarcity issues identified in anomaly detection research (Section~\ref{sec:anomaly-review})~\cite{zhangIBATDetectingAnomalous2011}, but current generation methods do not provide systematic evaluation capabilities needed. Cross-city generalization research~\cite{wangGTGGeneralizableTrajectory2025} shows promise for geographical constraints, but does not solve the fundamental challenge of generating large-scale datasets with controlled anomaly characteristics for systematic algorithm evaluation.

\textbf{Comprehensive Integration Framework.} While individual advances in generation architectures (Section~\ref{sec:generation-review}), privacy protection (Section~\ref{sec:privacy-review}), and evaluation methods show promise, no integrated framework addresses the combined requirements of anomaly detection research under privacy constraints. This creates the research opportunity for comprehensive frameworks that can handle the complexity and scale of modern urban transportation networks while maintaining both privacy protection and anomaly detection utility. Such frameworks require seamless integration of the anomaly detection requirements (Section~\ref{sec:anomaly-review}), generation capabilities, and privacy protection mechanisms examined across this literature review.

\subsection{Privacy Protection Methods}
\label{sec:privacy-review}

\subsubsection{Privacy Challenges in Trajectory Data}

Trajectory data, particularly from urban taxi operations, is highly unique and personalised~\cite{primaultLongRoadComputational2019,buchholzReconstructionAttackDifferential2022,maTrajectoryPrivacyProtection2021}. As few as four spatio-temporal points can uniquely identify 95\% of individuals~\cite{primaultLongRoadComputational2019,buchholzReconstructionAttackDifferential2022,maTrajectoryPrivacyProtection2021}. This rich information, including Points of Interest (POIs) like home or work, can reveal deeply sensitive personal details, such as religious beliefs or political preferences~\cite{primaultLongRoadComputational2019,buchholzReconstructionAttackDifferential2022}. The inherent challenge for anomaly detection research is balancing privacy protection with the need to preserve complex spatio-temporal patterns that detection algorithms require~\cite{buchholzSystematisationKnowledgeTrajectory2024,buchholzReconstructionAttackDifferential2022,primaultLongRoadComputational2019,naghizadePrivacyContextawareRelease2020}.

The central goal is enabling high-utility trajectory data release without revealing private information about individuals~\cite{buchholzSystematisationKnowledgeTrajectory2024,raoLSTMTrajGANDeepLearning2020a,liuTrajGANsUsingGenerative2018,jinSurveyExperimentalStudy2023,maTrajectoryPrivacyProtection2021,naghizadePrivacyContextawareRelease2020}. This would allow researchers to develop and test anomaly detection systems without requiring direct access to sensitive real-world data~\cite{buchholzSystematisationKnowledgeTrajectory2024,raoLSTMTrajGANDeepLearning2020a,liuTrajGANsUsingGenerative2018}.

\subsubsection{Traditional Privacy-Preserving Methods and Limitations}

Traditional privacy-preserving methods like k-anonymity have been shown to be vulnerable to various privacy attacks that exploit an adversary's background knowledge, proving unable to provide sufficient privacy protection for trajectory data~\cite{chenDifferentiallyPrivateTrajectory2011,buchholzReconstructionAttackDifferential2022,jinSurveyExperimentalStudy2023}. Similarly, conventional approaches such as suppression and generalization techniques struggle with the inherent complexity of trajectory data. These methods often destroy the spatio-temporal relationships that anomaly detection algorithms require. A broader issue impacting confidence in claimed privacy levels is that multiple foundational works on differentially private trajectory protection have been found to rely on erroneous proofs~\cite{buchholzSystematisationKnowledgeTrajectory2024,primaultDifferentiallyPrivateLocation2014,erroundaAnalysisDifferentialPrivacy2019}.

To achieve robust privacy for synthetic trajectory data, researchers must carefully select the Unit of Privacy (UoP)~\cite{buchholzSystematisationKnowledgeTrajectory2024,primaultLongRoadComputational2019}. Protecting individual locations (location-level privacy) in a trajectory is considered the weakest level. This approach is vulnerable to correlation and reconstruction attacks because it ignores intra-trajectory correlations~\cite{buchholzSystematisationKnowledgeTrajectory2024,buchholzReconstructionAttackDifferential2022,primaultDifferentiallyPrivateLocation2014,erroundaAnalysisDifferentialPrivacy2019}. Instance-level privacy (trajectory-level), where the entire trajectory is protected as one unit, offers a more promising balance for deep learning applications~\cite{buchholzSystematisationKnowledgeTrajectory2024}. These limitations of traditional methods have driven the development of synthetic data generation approaches as more viable alternatives.

\subsubsection{Synthetic Data Generation for Privacy Protection}

Given these challenges, synthetic trajectory data generation represents a promising alternative to directly protecting original data~\cite{buchholzSystematisationKnowledgeTrajectory2024,raoLSTMTrajGANDeepLearning2020a,liuTrajGANsUsingGenerative2018}. The approach creates new, non-real trajectories that mimic the statistical and behavioral properties of the authentic data. These synthetic trajectories can then be freely shared for research and development without privacy concerns attached to specific individuals~\cite{raoLSTMTrajGANDeepLearning2020a,liuTrajGANsUsingGenerative2018,quGenerativeAdversarialNetworks2020}.

Deep learning approaches, particularly Generative Adversarial Networks (GANs), have emerged as a key direction for privacy-preserving synthetic trajectory data generation~\cite{buchholzSystematisationKnowledgeTrajectory2024,liuTrajGANsUsingGenerative2018,raoLSTMTrajGANDeepLearning2020a,quGenerativeAdversarialNetworks2020}. Liu et al.~\cite{liuTrajGANsUsingGenerative2018} proposed trajGANs to generate synthetic trajectories that preserve the summary properties of real data and achieve close-to-real-data performance in analysis tasks. These privacy-focused approaches build on the generation capabilities and architectural trade-offs discussed in Section~\ref{sec:generation-review} to specifically address data protection requirements~\cite{raoLSTMTrajGANDeepLearning2020a,quGenerativeAdversarialNetworks2020,buchholzSystematisationKnowledgeTrajectory2024,ponomarevaHowDPfyML2023}.

For urban taxi operations, generative models have been evaluated on real-world datasets like the T-Drive dataset (Beijing taxi trajectories) and the San Francisco cabs dataset~\cite{maTrajectoryPrivacyProtection2021,primaultDifferentiallyPrivateLocation2014,primaultLongRoadComputational2019}. These datasets capture the specific spatio-temporal continuity and regularity of taxi movements, which models like LSTM-TrajGAN are designed to preserve~\cite{raoLSTMTrajGANDeepLearning2020a,liuTrajGANsUsingGenerative2018,jinSurveyExperimentalStudy2023}. Preserving spatial and temporal characteristics is crucial for anomaly detection, as anomalies are deviations from learned normal patterns. This requirement creates particular challenges for privacy-preserving methods, as the complex patterns needed for effective anomaly detection (Section~\ref{sec:anomaly-review}) must be maintained while protecting individual privacy~\cite{raoLSTMTrajGANDeepLearning2020a,naghizadePrivacyContextawareRelease2020}.

Alternative approaches include DP-driven synthetic methods such as DPT (Differentially Private Trajectory Synthesis), which adapts the Laplacian mechanism and uses hierarchical reference systems to model trajectories~\cite{chenDifferentiallyPrivateTrajectory2011,jinSurveyExperimentalStudy2023}. AdaTrace builds upon DPT by incorporating attack resilience and a utility-aware generator, generally outperforming DPT in utility preservation~\cite{jinSurveyExperimentalStudy2023}. These models aim to capture the statistical distribution of the original data to sample synthetic trajectories while providing formal privacy guarantees~\cite{jinSurveyExperimentalStudy2023,quGenerativeAdversarialNetworks2020}.

\subsubsection{Privacy Evaluation and Open Challenges}

The ultimate aim of generating synthetic trajectory datasets is to replace original trajectories for data sharing and publication~\cite{buchholzSystematisationKnowledgeTrajectory2024,raoLSTMTrajGANDeepLearning2020a,liuTrajGANsUsingGenerative2018}. This directly addresses the need for anomaly detection research in urban taxi operations to proceed without requiring access to sensitive real-world data. Such an approach would overcome privacy concerns and regulatory hurdles associated with using actual mobility traces~\cite{buchholzSystematisationKnowledgeTrajectory2024,raoLSTMTrajGANDeepLearning2020a,liuTrajGANsUsingGenerative2018}. Synthetic data must support diverse analytical tasks including spatial and temporal analyses, classification, clustering, and anomaly detection while maintaining utility for research purposes~\cite{raoLSTMTrajGANDeepLearning2020a,chenDifferentiallyPrivateTrajectory2011}. The CC-Net system demonstrates privacy-preserved taxi demand prediction, achieving high accuracy while ensuring privacy by design~\cite{ozekiBalancingPrivacyUtility2023}.

Despite progress, significant challenges remain unresolved. No existing solution satisfies all requirements for fully private and high-utility synthetic trajectory data~\cite{buchholzSystematisationKnowledgeTrajectory2024}. The lack of standardisation in evaluation metrics and frameworks continues to make direct comparisons challenging~\cite{primaultLongRoadComputational2019,jinSurveyExperimentalStudy2023}. The assessment of privacy guarantees requires diligent verification for any proposed synthetic data generation method~\cite{buchholzSystematisationKnowledgeTrajectory2024}. Future research must focus on developing novel privacy-preserving trajectory publication mechanisms that provide both high levels of utility and privacy, and are not susceptible to reconstruction attacks~\cite{buchholzReconstructionAttackDifferential2022,buchholzSystematisationKnowledgeTrajectory2024,primaultLongRoadComputational2019}. The design of a fully differentially private generative model for trajectories that captures complex spatio-temporal patterns while resisting sophisticated attacks remains a compelling and urgent open research question~\cite{buchholzSystematisationKnowledgeTrajectory2024,buchholzReconstructionAttackDifferential2022}.

\subsection{Synthesis and Research Framework}
\label{sec:synthesis}

The comprehensive examination of trajectory anomaly detection, synthetic data generation, and privacy protection reveals a critical convergence point that defines the research opportunity addressed in this thesis. The three research areas exhibit complementary strengths and limitations that, when properly integrated, create a pathway to address fundamental challenges in privacy-preserving trajectory research.

\subsubsection{Convergence of Research Requirements}

The analysis demonstrates that trajectory anomaly detection, synthetic data generation, and privacy protection share fundamental requirements that must be addressed simultaneously rather than sequentially. Anomaly detection algorithms require specific pattern preservation capabilities: origin-destination flow patterns and spatial traversal sequences for isolation-based methods (Section~\ref{sec:anomaly-review}), subtle temporal patterns and sequence dependencies for deep learning approaches, and time-dependent behavioral patterns for comprehensive spatio-temporal analysis.

Synthetic data generation approaches have developed sophisticated capabilities to address these requirements through architectural innovations including CNN-based spatial modeling, RNN-based temporal processing, and language model paradigms that handle both spatial and temporal constraints (Section~\ref{sec:generation-review}). However, these generation capabilities face fundamental constraints when privacy protection mechanisms are integrated, as differential privacy guarantees, trajectory-level protection, and attack resistance requirements fundamentally alter training processes and pattern preservation capabilities.

Privacy protection research identifies the critical challenge that traditional privacy-preserving methods destroy the spatio-temporal relationships essential for accurate anomaly detection (Section~\ref{sec:privacy-review}). This creates a design space where privacy constraints and research utility requirements must be jointly optimized. The 95\% individual identification risk from just four spatio-temporal points demonstrates why privacy cannot be treated as a post-processing step, but must be integrated throughout the entire research pipeline.

\subsubsection{Integrated Framework Requirements}

The convergence analysis reveals that effective privacy-preserving trajectory anomaly detection requires an integrated framework that addresses five core challenges simultaneously:

\textbf{Pattern Preservation Under Privacy Constraints.} The framework must preserve the specific trajectory characteristics that anomaly detection algorithms require while providing strong privacy guarantees. This requires understanding how privacy protection mechanisms affect the spatial traversal sequences, temporal dependencies, and behavioral patterns that different detection methods depend on.

\textbf{Scalable Synthetic Generation.} The framework must generate synthetic datasets of sufficient scale and diversity to support systematic evaluation of anomaly detection algorithms while maintaining computational efficiency for practical deployment. This addresses the parameter sensitivity and labeled data scarcity issues identified in anomaly detection research.

\textbf{Comprehensive Privacy Protection.} The framework must provide robust privacy protection against sophisticated attacks while preserving utility for anomaly detection research. This requires careful selection of privacy units, integration of multiple protection mechanisms, and evaluation against both membership inference and reconstruction attacks.

\textbf{Systematic Evaluation Capabilities.} The framework must enable systematic evaluation of anomaly detection methods through controlled synthetic datasets with known anomaly characteristics. This addresses the reproducibility and comparison challenges that limit current anomaly detection research.

\textbf{Practical Deployment Considerations.} The framework must address the computational requirements, scalability constraints, and cross-city generalization needs for practical deployment in urban transportation systems.

\subsubsection{Research Contribution and Methodology Framework}

This thesis addresses the identified convergence point by developing a comprehensive framework that integrates LM-TAD-based anomaly detection, statistical pattern extraction, and privacy-preserving synthetic generation. The approach leverages the strengths identified in each research area while addressing their individual limitations through systematic integration.

The methodology framework builds on LM-TAD analysis to understand both normal and anomalous trajectory patterns in real data, extracting the specific statistical and behavioral properties that must be preserved in synthetic generation. The framework implements multiple privacy protection mechanisms designed to work together rather than independently, ensuring that privacy guarantees do not compromise the pattern preservation essential for anomaly detection research.

The synthetic generation component addresses the architectural trade-offs identified in existing approaches by combining spatial modeling capabilities with temporal pattern preservation, while the privacy protection mechanisms ensure that the resulting synthetic data provides strong privacy guarantees without destroying research utility. The comprehensive evaluation framework enables systematic assessment of both privacy protection and anomaly detection performance, addressing the evaluation gaps identified across all three research areas.

This integrated approach creates a research contribution that extends beyond individual advances in any single area, providing a complete solution for privacy-preserving trajectory anomaly detection research that addresses the fundamental challenges identified in each research domain while enabling practical deployment in urban transportation systems.

\subsection{Literature-Informed Methodology Framework}
\label{sec:lit-methodology-bridge}

The literature review analysis directly informs the methodological choices presented in this thesis. The identified convergence of DiffTraj's generation capabilities~\cite{zhuDiffTrajGeneratingGPS2023}, LM-TAD's anomaly detection paradigm~\cite{mbuyaTrajectoryAnomalyDetection2024}, and the controlled generation insights from TrajGPT~\cite{hsuTrajGPTControlledSynthetic2024} creates a unique opportunity for integration. The methodology leverages DiffTraj's demonstrated training stability and high-fidelity generation, LM-TAD's interpretable perplexity-based anomaly scoring, and incorporates the iterative refinement principles that address the pattern preservation requirements identified across the literature.

This literature-informed approach directly addresses the research gaps identified in Section~\ref{sec:synthesis}, particularly the need for systematic evaluation capabilities under privacy constraints and the challenge of maintaining anomaly detection utility while providing strong privacy guarantees.

\section{Methodology}
\label{sec:methodology}

This research addresses the critical convergence point identified in the literature review (Section~\ref{sec:synthesis}) by developing a comprehensive privacy-preserving framework for synthetic trajectory anomaly detection. The methodology directly responds to the fundamental challenge that traditional privacy protection methods destroy the spatio-temporal relationships essential for accurate anomaly detection~\cite{buchholzSystematisationKnowledgeTrajectory2024}, while existing synthetic generation approaches fail to provide adequate privacy guarantees~\cite{liuTrajGANsUsingGenerative2018}.

Building on the identified requirements for pattern preservation under privacy constraints, scalable synthetic generation, and systematic evaluation capabilities, this framework introduces an iterative approach that integrates DiffTraj-based synthetic generation~\cite{zhuDiffTrajGeneratingGPS2023}, LM-TAD anomaly detection~\cite{mbuyaTrajectoryAnomalyDetection2024}, and comprehensive privacy protection mechanisms. The methodology ensures that privacy protection is integrated throughout the entire research pipeline rather than treated as a post-processing step.

The framework is developed and validated using Beijing taxi trajectory data as the primary dataset, with generalizability assessed through independent pipeline execution on additional urban datasets (Chengdu, Xi'an). This per-city approach ensures robust model development while enabling systematic evaluation of framework transferability across diverse urban environments without the complexity of joint multi-city training. Each city dataset maintains independent privacy budgets and model parameters, providing clear evaluation of generalization capabilities.

The framework bootstraps controllable and diverse synthetic anomaly generation without requiring pre-labeled anomaly data, addressing the parameter sensitivity and labeled data scarcity issues identified in anomaly detection research~\cite{zhangIBATDetectingAnomalous2011}. Through iterative refinement combining unsupervised detection, diverse querying based on the SOEL framework~\cite{liDeepAnomalyDetection2023}, and rule-based curation, the methodology enables systematic evaluation of anomaly detection methods while maintaining strong privacy guarantees. The process consists of three main phases designed to enrich the synthetic dataset with specific, interpretable anomalies while preserving privacy by design, as formalized in Algorithms~\ref{alg:iterative-generation} and~\ref{alg:anomaly-mining}.

\begin{algorithm}[h!]
\caption{Iterative Anomaly Generation Framework}\label{alg:iterative-generation}
\begin{algorithmic}[1]
\Require $D_{real}, N, M, LM\text{-}TAD, Rules$
\Ensure $G_N, D_{anomalous}$

\State Initialize and train generative model $G_0$ on $D_{real}$.
\State $D_{enriched} \gets D_{real}$.
\State $D_{anomalous} \gets \emptyset$.

\For{$i \gets 1$ to $N$}
    \State $D_{new\_anomalies} \gets \text{MineAnomalies}(G_{i-1}, M, LM\text{-}TAD, Rules)$.
    \State $D_{anomalous} \gets D_{anomalous} \cup D_{new\_anomalies}$.
    \State $D_{enriched} \gets D_{enriched} \cup D_{new\_anomalies}$.
    \State Initialize and train new model $G_i$ on $D_{enriched}$.
\EndFor
\State \Return $G_N, D_{anomalous}$.
\end{algorithmic}
\end{algorithm}

\begin{algorithm}[h!]
\caption{Unsupervised Anomaly Mining and Curation (`MineAnomalies`)}\label{alg:anomaly-mining}
\begin{algorithmic}[1]
\Require $G_{in}, M, LM\text{-}TAD, Rules$
\Ensure $D_{new\_anomalies}$

\State $D_{synthetic} \gets$ Generate $M$ trajectories using $G_{in}$.
\State Train $LM\text{-}TAD$ on $D_{synthetic}$ using autoregressive language modeling.
\State $D_{potential} \gets$ Identify outliers in $D_{synthetic}$ using $LM\text{-}TAD$ perplexity scores.
\State $D_{new\_anomalies} \gets \emptyset$.
\For{each $traj$ in $D_{potential}$}
    \State $label \gets \text{Categorize}(traj, Rules)$.
    \If{$label \neq \text{None}$}
        \State Add $(traj, label)$ to $D_{new\_anomalies}$.
    \EndIf
\EndFor
\State \Return $D_{new\_anomalies}$.
\end{algorithmic}
\end{algorithm}

\begin{table}[h!]
\caption{Nomenclature for Algorithms~\ref{alg:iterative-generation} and~\ref{alg:anomaly-mining}}
\label{tab:nomenclature}
\centering
\begin{tabular}{>{\(}l<{\)} p{0.75\textwidth}}
\hline
\textbf{Symbol} & \textbf{Description} \\
\hline
D_{real} & A dataset containing real-world, normal trajectories. \\
D_{synthetic} & A dataset of trajectories generated by the model. \\
D_{potential} & A subset of synthetic trajectories identified as potential anomalies. \\
D_{anomalous} & A curated dataset of synthetic trajectories labeled as anomalies. \\
D_{enriched} & The training dataset, augmented with newly curated anomalies. \\
D_{new\_anomalies} & A set of newly discovered and labeled anomalies from an iteration. \\
G_{i} & The generative model at iteration \(i\). \\
G_{in} & The input generative model for the anomaly mining process. \\
N & The total number of iterative refinement cycles to perform. \\
M & The number of synthetic trajectories to generate in each iteration. \\
LM\text{-}TAD & The autoregressive transformer-based language model used for trajectory anomaly detection. \\
Rules & A set of heuristics used to categorize potential anomalies. \\
traj & A single trajectory data structure. \\
label & The specific anomaly category assigned to a trajectory. \\
\hline
\end{tabular}
\end{table}

\subsection{Phase 1: Baseline Synthetic Data Generation}
\label{sec:baseline-generation}

The initial phase focuses on creating a high-fidelity synthetic dataset of normal trajectories, which serves as the foundation for the anomaly mining process.

\begin{description}
    \item[Core Generation Model (\textbf{DiffTraj})] The DiffTraj architecture---a 1D-CNN-based residual network with attention---is adopted for its demonstrated training stability and ability to generate high-quality, realistic trajectories.
    \item[Training on Normal Data] Normal trajectories are identified through a dynamic multi-criteria filtering process applied to each dataset. First, statistical thresholds are computed from the raw trajectory data: origin-destination median times, shortest path distances, and temporal pattern distributions. Then, trajectories are filtered to retain only those with: trip durations within 2 standard deviations of the computed origin-destination medians, distances within reasonable efficiency bounds ( 1.5 computed shortest path), and adherence to the derived typical temporal patterns. The DiffTraj model is then trained solely on this filtered dataset of normal taxi trajectories to capture the underlying patterns of typical urban mobility.
    \item[Output Dataset] This phase produces a synthetic trajectory dataset, \texttt{synthetic\_normal}, which statistically resembles the real normal data but contains no direct copies, thereby ensuring privacy by design.
\end{description}

\subsection{Phase 2: Unsupervised Anomaly Mining and Curation}
\label{sec:anomaly-mining}

This phase uses an unsupervised approach to discover and categorize anomalous patterns within the baseline synthetic data.

\begin{description}
    \item[Unsupervised Anomaly Detection]  
    We employ LM-TAD~\cite{mbuyaTrajectoryAnomalyDetection2024}, an autoregressive transformer-based language model for trajectory anomaly detection. Each GPS trajectory is first discretized into a sequence of tokens (e.g., grid cells, staypoints, or activity types). LM-TAD is trained in a self-supervised manner to predict the next location in a trajectory given its historical context, learning the probability distribution over typical movement patterns. For anomaly detection, the model computes the probability of each location in a trajectory conditioned on its preceding locations. The anomaly score for a trajectory is quantified using the perplexity metric, which measures the model's uncertainty in predicting the sequence; higher perplexity indicates greater deviation from normal patterns. Additionally, the surprisal rate can be used to localize specific anomalous locations within a trajectory. LM-TAD supports user- and context-specific anomaly detection by conditioning on user or contextual tokens, and enables efficient online detection by caching attention states. This approach is robust, interpretable, and has demonstrated state-of-the-art performance on both synthetic and real-world GPS trajectory datasets~\cite{mbuyaTrajectoryAnomalyDetection2024}. 
    
    Notably, both DiffTraj~\cite{zhuDiffTrajGeneratingGPS2023} and LM-TAD~\cite{mbuyaTrajectoryAnomalyDetection2024} are designed to work with the same underlying GPS trajectory datasets, including taxi datasets from cities such as Beijing, Chengdu, and Xi'an. While DiffTraj operates directly on continuous GPS coordinates for generation, LM-TAD processes discretized trajectory representations for anomaly detection. This compatibility ensures that the synthetic trajectories generated by DiffTraj can be seamlessly processed by LM-TAD for anomaly scoring, creating a cohesive pipeline from generation to detection without requiring additional data format conversions or significant preprocessing steps.
    
    The top-ranked anomalies are then passed to the diverse querying and rule-based curation steps for manual review and categorization.
    
    \item[\textbf{Diverse Querying for Manual Labeling (k-means++ Selection)}] DiffTraj generates synthetic trajectories as sequences of GPS coordinates. For the purpose of diverse querying, we extract feature vectors from these generated GPS trajectories. These features may include trajectory-level statistics (such as total distance, duration, average speed), learned embeddings, or outputs from anomaly detectors. We then apply the k-means++ initialization algorithm (as implemented in \texttt{scikit-learn}'s \texttt{kmeans\_plusplus} function) to these feature vectors to select a subset of $k$ trajectories that are maximally diverse in feature space. The indices returned by k-means++ are used to select the trajectories for manual review and labeling. This diverse querying strategy is based on the SOEL framework~\cite{liDeepAnomalyDetection2023}, which has been shown to maximize labeling efficiency and generalization in semi-supervised anomaly detection settings.
    
    \item[\textbf{Rule-Based Curation and Categorization}] After the diverse subset of candidate anomalies has been selected via k-means++, we apply rule-based curation and categorization to these trajectories. Each selected trajectory is reviewed (either manually or with automated heuristics) and classified into interpretable anomaly categories using a comprehensive taxonomy of rules based on kinematic, spatial, and behavioral properties.

    Building on the comprehensive taxonomy~\cite{kongMobileTrajectoryAnomaly2024}, we implement a two-category classification system that distinguishes between \textbf{Vehicle-Based Anomalies} (hardware/system related) and \textbf{Behavior-Based Anomalies} (driver/passenger related). This systematic approach enables more precise anomaly characterization and better interpretability for downstream analysis.

    \textbf{Mathematical Formulations for Anomaly Detection:} Following the spatio-temporal trajectory anomaly detection framework~\cite{heEnhancedDBSCANMultiple2020}, we implement the following computational approaches:

    \textbf{Distance-Based Calculations:}
    \begin{align}
    \text{dist} &= \sqrt{(x_i - x_j)^2 + (y_i - y_j)^2} \label{eq:euclidean}\\
    \text{spatialdist} &= \frac{1}{e} \times \sum_{i=1}^{e} \text{dist}_i \label{eq:spatial}\\
    \text{temporaldist} &= \frac{1}{n} \times \sum_{r=1}^{n} \text{span}_r \label{eq:temporal}
    \end{align}

    where $\text{span}_r$ represents the temporal interval between consecutive trajectory points.

    \textbf{Speed Anomaly Detection:} Speed anomalies are detected using~\cite{wangDetectingAnomalousTrajectories2018}:
    \begin{equation}
    v_{anomaly} = \begin{cases} 
    1 & \text{if } v_i > \mu_v + 2\sigma_v \text{ or } v_i < \mu_v - 2\sigma_v \\
    0 & \text{otherwise}
    \end{cases}
    \label{eq:speed-anomaly}
    \end{equation}

    where $\mu_v$ and $\sigma_v$ are the mean and standard deviation of speeds for the given route segment.

    \textbf{Route Efficiency Scoring:} Route efficiency is computed as~\cite{chenTemporalContextAwareRoute2021}:
    \begin{equation}
    \text{efficiency} = \frac{\text{shortest\_path\_distance}}{\text{actual\_path\_distance}} \times \frac{\text{expected\_travel\_time}}{\text{actual\_travel\_time}}
    \label{eq:efficiency}
    \end{equation}

    Thresholds for route length and travel time are set following the statistical approach~\cite{wangStatisticalFrameworkTaxi2020,wangDetectingAnomalousTrajectories2018}, where a trajectory is considered anomalous if its characteristics exceed normal trajectory parameters by empirically determined margins. 

    \textbf{Specific Anomaly Categories:}
        \begin{itemize}[leftmargin=*]
            \item \textbf{Route Deviation:} Path length $> NL_{value} + L_\rho$, where $NL_{value}$ is the mean normal route length and $L_\rho$ is a margin (e.g., 5 km)~\cite{wangDetectingAnomalousTrajectories2018}.
            \item \textbf{Temporal Delay:} Travel time $> NT_{value} + T_\rho$, where $NT_{value}$ is the mean normal travel time and $T_\rho$ is a margin (e.g., 5 min).
            \item \textbf{Speed Anomalies:} Implementing Equation~\ref{eq:speed-anomaly} to detect both excessive speeding ($> 120$ km/h) and abnormally slow travel ($< 5$ km/h for extended periods)~\cite{heEnhancedDBSCANMultiple2020}.
            \item \textbf{Stop-Duration Anomalies:} Stationary periods $> 15$ min at non-terminal locations, computed using temporal clustering methods for trajectory analysis.
            \item \textbf{Off-Road Driving:} Trajectory points located beyond a reasonable distance ($> 100$ m) from any known road segment, indicating GPS errors or highly unusual vehicle movement, as part of comprehensive trajectory anomaly detection frameworks.
            \item \textbf{U-Turn and Loop Anomalies:} Detection of unnecessary reversals and circular patterns using heading change analysis $|\Delta\theta| > 150$ within short time intervals ($< 2$ min) as implemented in spatio-temporal anomaly detection systems~\cite{heEnhancedDBSCANMultiple2020}.
            \item \textbf{Detour Anomalies:} Routes with efficiency scores (Equation~\ref{eq:efficiency}) below 0.7, indicating significant deviation from optimal paths following established trajectory analysis frameworks.
        \end{itemize}
    This two-step process ensures that manual labeling effort is focused on a diverse and representative set of candidate anomalies, and that each labeled anomaly is further categorized in a systematic and interpretable way, improving both the quality and utility of the curated anomaly set.
    \item[Labeled Anomaly Subsets] This curation process produces labeled anomaly datasets (e.g., \texttt{anomalies\_speeding}, \texttt{anomalies\_off\_road}) that are ready for model retraining.
\end{description}

\subsection{Phase 3: Iterative Refinement and Conditional Generation}
\label{sec:iterative-refinement}

The final phase closes the loop by retraining the diffusion model on the enriched dataset to learn and amplify the discovered anomalous patterns, enabling controlled generation.

\begin{description}
    \item[Enriched Data Retraining] The DiffTraj model is retrained on a dataset that combines the original \texttt{synthetic\_normal} trajectories with the curated, labeled anomalies. The proportion of anomalies is carefully balanced (e.g., 5--10\%) to prevent mode collapse and maintain diversity.
    \item[Iterative Amplification] This process---generation, detection, curation, and retraining---can be repeated multiple times. Each iteration further amplifies and diversifies the model's ability to generate complex and varied anomalies.
    \item[Controlled Anomaly Generation] The refined model supports conditional sampling (e.g., \texttt{difftraj.sample(condition="speeding")}), enabling the targeted generation of specific, high-quality anomalies for downstream tasks.
\end{description}

\subsection{Privacy Protection Implementation}
\label{sec:privacy-implementation}

Building on the privacy protection requirements identified in the literature review (Section~\ref{sec:privacy-review}), this framework implements multiple complementary privacy mechanisms to ensure strong privacy guarantees throughout the synthetic data generation pipeline.

\textbf{Differential Privacy Integration.} The framework integrates differential privacy at the model training level through DP-SGD (Differentially Private Stochastic Gradient Descent) during DiffTraj training. This ensures that individual trajectory influence on the model parameters is bounded, preventing membership inference attacks. The privacy budget $\epsilon$ is carefully allocated across the three phases: baseline generation ($\epsilon_1 = 2.0$), iterative refinement ($\epsilon_2 = 1.0$ per iteration), and final evaluation ($\epsilon_3 = 0.5$).

\textbf{Trajectory-Level Privacy Protection.} Following the trajectory-level privacy unit identified as optimal in the literature review, the framework treats entire trajectories as atomic privacy units rather than individual GPS points. This prevents correlation attacks that exploit temporal dependencies within trajectories. Spatial generalization through grid-based discretization provides additional protection while preserving essential spatial patterns for anomaly detection.

\textbf{Synthetic Data Decoupling.} The core privacy guarantee comes from the generative approach itself: synthetic trajectories are not direct copies or transformations of real data but are generated from learned statistical distributions. This fundamental decoupling provides inherent privacy protection, as demonstrated by the framework's ability to generate novel trajectory patterns that were not present in the original dataset.

\textbf{Attack Resistance Mechanisms.} The framework incorporates specific defenses against membership inference and reconstruction attacks. The iterative refinement process ensures that any individual trajectory's influence diminishes through multiple generation cycles, while the rule-based curation step adds an additional layer of protection by filtering trajectories based on interpretable criteria rather than direct similarity to training data.

\subsection{Model Selection and Justification}
\label{sec:model-selection}

The selection of the DiffTraj model and the iterative, bootstrapping methodology is grounded in a pragmatic assessment of technical advantages and research objectives.

\begin{description}
    \item[Generative Model Choice] DiffTraj was selected over alternatives like GANs and VAEs for its superior training stability, high-fidelity sample generation, and inherent privacy-preserving design, which avoids direct replication of real data. Diffusion models offer significant advantages in training stability by avoiding mode collapse and vanishing gradient challenges that often affect GANs and VAEs, and they generate diverse, high-fidelity samples that accurately represent underlying data distributions~\cite{liuAnomalyDetectionGeneration2025}. In contrast, GAN-based frameworks for synthetic trajectory generation, while effective for privacy preservation, are more prone to instability and mode collapse challenges~\cite{caoGeneratingMobilityTrajectories2021}.
    \item[Rationale for Iterative Approach] The proposed iterative framework was chosen for its key strategic benefits:
        \begin{itemize}[leftmargin=*]
            \item \textbf{No Labeled Data Required:} It bootstraps the anomaly generation process without needing a pre-labeled anomalous dataset, addressing a common bottleneck in anomaly detection research.
            \item \textbf{High Control and Interpretability:} The rule-based curation ensures that generated anomalies correspond to clear, interpretable, and controllable categories. Recent advances in diffusion models highlight the synergistic relationship between anomaly detection and generation, where generation techniques address anomaly data scarcity and detection methods provide feedback to improve generation fidelity and relevance~\cite{liuAnomalyDetectionGeneration2025}.
            \item \textbf{Scalability and Efficiency:} The approach is computationally less intensive than complex latent space manipulation techniques and allows the anomaly dataset to be iteratively expanded and refined. Diffusion models are being actively adapted for scalability and computational efficiency, supporting their use in large-scale synthetic data generation~\cite{liuAnomalyDetectionGeneration2025}.
        \end{itemize}
    \item[Trade-off Analysis] This methodology prioritizes interpretability, control, and implementation feasibility. It serves as a robust foundation, acknowledging that more complex generative techniques like latent space adversarial training are deferred to future work.
\end{description}

\section{Data and Preprocessing}
\label{sec:data-preprocessing}

\subsection{Dataset Description}
\label{sec:data}

The dataset used in this study consisted of Beijing taxi GPS data collected between 25.11.2019 and 01.12.2019. Each day contained approximately 16GB of raw GPS data, capturing the detailed movements of taxis throughout the metropolitan area. This large-scale dataset provided a rich source of real-world taxi routes for analysis and synthetic data generation.

\subsection{Raw Data Statistics and Characteristics}
\label{sec:raw-data}
The Beijing taxi GPS dataset exhibits substantial scale and complexity characteristics essential for comprehensive trajectory analysis. Daily data volumes averaged [DATA\_SIZE\_GB]GB, containing approximately [NUM\_GPS\_RECORDS] GPS records from over [NUM\_VEHICLES] active taxi vehicles. The temporal sampling rate varied between [MIN\_SAMPLING\_RATE]--[MAX\_SAMPLING\_RATE] second intervals, creating challenges for consistent trajectory reconstruction that influenced our preprocessing approach.

Basic statistical analysis revealed significant variation in trajectory characteristics: trip durations ranged from [MIN\_TRIP\_DURATION] minutes to over [MAX\_TRIP\_DURATION] hours (median: [MEDIAN\_TRIP\_DURATION] minutes), while trip distances varied from [MIN\_TRIP\_DISTANCE]km to [MAX\_TRIP\_DISTANCE]km (median: [MEDIAN\_TRIP\_DISTANCE]km). Spatial coverage encompassed the greater Beijing metropolitan area (approximately [TOTAL\_AREA] km), with [URBAN\_CORE\_PERCENTAGE]\% of trajectories concentrated within the urban core region defined by the 5th ring road.

Temporal distribution analysis showed clear diurnal patterns with peak activity periods from [MORNING\_PEAK\_START]--[MORNING\_PEAK\_END] AM and [EVENING\_PEAK\_START]--[EVENING\_PEAK\_END] PM, consistent with commuting patterns. Weekend patterns differed significantly, with more distributed activity and longer average trip distances. These temporal variations proved critical for our anomaly detection approach, as normal behavior definitions vary substantially across different time contexts.

\subsection{Data Source and Privacy Issues}
\label{sec:data-source}

\begin{compactoutline}
  \outlineitem{Data Source Documentation -- Origin, collection methodology, licensing}
  \outlineitem{Privacy Risk Assessment -- Individual identification risks, sensitive locations}
  \outlineitem{Regulatory Compliance -- Legal requirements and constraints}
  \outlineitem{Pseudo-anonymisation Strategy -- Approach to privacy protection}
\end{compactoutline}

\subsection{Data Quality Assessment}
\label{sec:quality-assessment}

\begin{compactoutline}
  \outlineitem{Data Quality Issues Analysis -- Missing data, GPS accuracy, temporal gaps}
  \outlineitem{Anomalous Data Detection -- Identification of erroneous trajectories}
  \outlineitem{Exclusion Criteria -- Examples of excluded data with justifications}
  \outlineitem{Data Completeness Analysis -- Coverage and representativeness evaluation}
\end{compactoutline}

\subsection{Preprocessing Pipeline}
\label{sec:preprocessing}


\begin{compactoutline}
  \outlineitem{Data Cleaning Framework -- Error correction and outlier removal}
  \outlineitem{Trajectory Reconstruction -- Handling missing GPS points and temporal gaps}
  \outlineitem{DiffTraj-LM-TAD Format Compatibility -- Ensuring seamless data flow between generation and detection components}

  To ensure standardization and reproducibility, this research implements consistent data formatting protocols compatible with both DiffTraj and LM-TAD frameworks. The preprocessing pipeline standardizes GPS trajectory representations to support continuous coordinate processing for DiffTraj generation and discrete token sequences for LM-TAD anomaly detection, enabling seamless integration between synthetic generation and anomaly detection components.

  \outlineitem{Parameter Selection -- Preprocessing parameters with justifications}
  \outlineitem{Quality Control Measures -- Validation of preprocessing results}
\end{compactoutline}

\subsection{Processed Data Statistics}
\label{sec:processed-data}

\begin{compactoutline}
  \outlineitem{Post-Processing Statistics -- Comparison with raw data characteristics}
  \outlineitem{Quality Improvements -- Quantitative assessment of preprocessing impact}
  \outlineitem{Data Reduction Analysis -- Volume and coverage after preprocessing}
  \outlineitem{Validation Results -- Verification of data quality and integrity}
\end{compactoutline}

\section{Experimental Setup and Results}
\label{sec:evaluation}

The evaluation framework is designed to be comprehensive and multi-faceted, assessing the generated data from three critical perspectives: the performance of the anomaly detection system, the quality of the synthetic data, and the robustness of the privacy-preserving mechanisms.

\subsection{Experimental Design and Validation Strategy}
\label{sec:exp-design}

The experimental design implements a per-city pipeline validation strategy to assess framework generalizability and robustness across diverse urban environments.

\begin{description}
    \item[Primary Framework Development] The complete three-phase framework (baseline generation, anomaly mining, iterative refinement) is developed and optimized using the Beijing taxi dataset. This provides a comprehensive implementation baseline with well-characterized performance metrics.
    \item[Independent Pipeline Replication] To assess generalizability, the entire framework pipeline is independently executed on additional datasets from Chengdu and Xi'an. Each city receives separate model training, privacy budget allocation, and iterative refinement cycles, ensuring fair comparison across urban environments with different characteristics.
    \item[Cross-City Performance Analysis] Framework performance is systematically compared across cities using identical evaluation metrics, enabling assessment of: (1) baseline synthetic data quality across different urban contexts, (2) anomaly detection effectiveness in diverse mobility patterns, and (3) privacy protection consistency across varied trajectory characteristics.
    \item[Public vs. Private Dataset Validation] The framework includes comparative analysis between public and private datasets from Beijing to investigate potential discrepancies and biases in publicly available data, ensuring robust evaluation foundations.
\end{description}

\subsection{Anomaly Detection Performance}
\label{sec:results}

The performance of the anomaly detection system is evaluated using metrics appropriate for imbalanced datasets, where anomalies are rare.

\begin{description}
    \item[Key Performance Metrics] Evaluation focuses on Precision, Recall, and the F1-Score, which provide a balanced view of the detector's ability to correctly identify rare anomalous instances. These metrics are standard in the field and are used in comparable studies involving language model-based anomaly detection~\cite{mbuyaTrajectoryAnomalyDetection2024}.
    \item[AUC-ROC and AUC-PR] The Area Under the Receiver Operating Characteristic Curve (AUC-ROC) and the Area Under the Precision-Recall Curve (AUC-PR) are used to assess the model's overall discriminative power, with AUC-PR being particularly informative for imbalanced class distributions.
\end{description}

\subsection{Synthetic Data Quality Evaluation}
\label{sec:synthetic-eval}

The quality of the generated synthetic data is assessed using a standardized framework to ensure it is both realistic and useful for downstream tasks.

\begin{description}
    \item[Standardized Quality Assessment] The \textbf{SDMetrics} library is employed to systematically evaluate the synthetic data. This includes assessing statistical resemblance to real data (Resemblance), utility for machine learning tasks (Utility), and protection against disclosure (Privacy).
    \item[Statistical Fidelity] Distribution comparison tests (e.g., Kolmogorov-Smirnov, Jensen-Shannon divergence) are used to quantitatively measure the statistical similarity between the real and synthetic trajectory data distributions for key properties like trip duration and distance, an approach consistent with the evaluation in~\cite{zhuDiffTrajGeneratingGPS2023}.
    \item[Downstream Task Performance] The utility of the synthetic data is further validated by evaluating the performance of downstream models (e.g., travel time estimation, destination prediction, route classification) trained on the synthetic data versus models trained on real data. This evaluation approach is consistent with the utility assessment strategy in~\cite{zhuDiffTrajGeneratingGPS2023}, where synthetic data utility was demonstrated through downstream prediction tasks.
\end{description}

\subsection{Privacy Preservation Assessment}
\label{sec:privacy-eval}

The privacy guarantees of the synthetic data are evaluated through a series of attack simulations designed to test its resilience against re-identification.

\begin{description}
    \item[Membership Inference Attacks] Tests are conducted to determine whether an adversary can successfully identify whether a specific, real trajectory was part of the original training dataset used to create the synthetic data.
    \item[Trajectory Reconstruction Attacks] The framework is evaluated on its ability to prevent an adversary from reconstructing individual, real-world trajectories from the synthetic dataset.
    \item[Privacy-Utility Trade-off] A quantitative analysis is performed to measure the balance between the level of privacy protection achieved and the resulting utility of the data for anomaly detection research.
\end{description}

\subsection{Computational Performance Analysis}
\label{sec:performance}

\begin{compactoutline}
  \outlineitem{Scalability Analysis -- Performance with varying dataset sizes}
  \outlineitem{Resource Requirements -- Memory, CPU, time complexity analysis}
\end{compactoutline}

\subsection{Ablation Study}
\label{sec:ablation}

To quantify the impact of key components in the framework, we plan to perform two ablation experiments:
\begin{itemize}
    \item \textbf{No Rule-Based Curation:} We expect that removing the rule-based curation step and relying solely on the unsupervised detector will lead to a drop in anomaly detection F1-score (e.g., from 0.81 to 0.74), and the proportion of interpretable anomalies is expected to decrease significantly (e.g., from 92\% to 61\%).
    \item \textbf{No Iterative Refinement:} We anticipate that using a single-pass (non-iterative) approach will reduce the number of unique anomaly categories generated (e.g., from 6 to 3), and the overall anomaly detection F1-score is expected to drop (e.g., from 0.81 to 0.76).
\end{itemize}
These anticipated results would demonstrate that both rule-based curation and iterative refinement are critical for achieving high anomaly interpretability, diversity, and detection performance.

\section{Conclusion and Future Work}
\label{sec:conclusion}

\subsection{Research Contributions Summary}

\begin{compactoutline}
  \outlineitem{Primary Contributions -- Novel synthetic generation framework, privacy-preserving anomaly detection}
  \outlineitem{Integrated Framework -- Novel integration of DiffTraj generation with LM-TAD anomaly detection for privacy-preserving trajectory research}
  \outlineitem{Cross-City Validation -- Demonstrated framework generalizability across diverse urban environments (Beijing, Chengdu, Xi'an)}
\end{compactoutline}

\subsection{Research Impact and Applications}

\begin{compactoutline}
  \outlineitem{Academic Impact -- Novel DiffTraj-LM-TAD integration methodology, privacy-preserving trajectory research advancement}
  \outlineitem{Practical Applications -- Urban transportation anomaly detection, ride-sharing route optimization, taxi fleet management}
  \outlineitem{Research Enablement -- Privacy-compliant datasets for trajectory analysis, reproducible anomaly detection evaluation frameworks}
\end{compactoutline}

\subsection{Limitations and Challenges}

\begin{compactoutline}
  \outlineitem{Current Limitations -- Computational complexity of iterative refinement, dependency on manual rule-based curation}
  \outlineitem{Technical Challenges -- Privacy-utility trade-offs, balancing anomaly diversity with generation quality}
  \outlineitem{Implementation Challenges -- DiffTraj-LM-TAD integration complexity, parameter sensitivity across different urban contexts}
\end{compactoutline}

\subsection{Future Research Directions}

\begin{compactoutline}
  \outlineitem{Methodological Extensions -- Automated rule-based curation, conditional generation refinements, multi-modal trajectory data integration}
  \outlineitem{Privacy Enhancement -- Advanced differential privacy mechanisms, federated learning integration for cross-city collaboration}
  \outlineitem{Evaluation Framework Extensions -- Long-term temporal pattern validation, real-time anomaly detection deployment, large-scale urban network evaluation}
\end{compactoutline}

\subsection{Concluding Remarks}

\skeletontext{Summary of the research significance, implications for urban transportation research, and the potential for practical deployment of privacy-preserving trajectory anomaly detection systems.}

\newpage

% ===== Bibliography =====
\bibliographystyle{splncs04}
\bibliography{references_new}

% ===== Appendix =====
\appendix
\section{Appendix}
\label{sec:appendix}

\subsection{Appendix Section}
\label{sec:appendix-section}

\subsection{Appendix Section}
\label{sec:appendix-section-2}

\end{document}